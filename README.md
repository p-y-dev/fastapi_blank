<details>

<summary>Информация для разработки</summary>

## Информация для разработки

### Подготовка нового проекта

В файле docker-compose.yml заменить все вхождения:

- app_postgis
- app_api
- app_redis
- app_bg_tasks

app - название проекта/сервиса, например user_postgis, user_api и т.д


### Запуск
1. Создать в корне проекта файл - .env, пример переменных среды в разделе ниже "Переменные среды окружения"
2. Запустить проект - ```make up```

### Миграции
1. Создать миграцию (проект должен быть запущен make up) - ```MIGR_NAME=examplename make migration```. Где ```MIGR_NAME``` название миграции (Необязательный параметр)
2. Применить миграции (проект должен быть запущен make up) - ```make migrate```

### Тесты
Запуск тестов (проект должен быть запущен make up) - ```make tests```

### URL: 

- DOCS Swagger - ```http://127.0.0.1:8002/docs```
- SAQ task monitoring - ```http://127.0.0.1:8002/saq_monitor```

### Все команды Make:
- ```make up``` - Запуск проекта
- ```make down``` - Остановка проекта
- ```make migration``` - Создание миграции
- ```make migrate``` - Применение миграции
- ```make check``` - Проверка кода lint + tests
- ```make logs | C_NAME=examplename make logs``` - Вывод логов. C_NAME - название контейнера
- ```make bash | C_NAME=examplename make bash``` - Вход в консоль контейнера. C_NAME - название контейнера
- ```make tests``` - Запуск тестов


</details>

<details>

<summary>Переменные среды окружения</summary>

#### База данных POSTGRES
| Переменная        | Тип  | Описание                                                                                   | Пример                     |
|-------------------|------|--------------------------------------------------------------------------------------------|----------------------------|
| POSTGRES_USER     | str  | Пользователь postgres                                                                      | postgres                   |
| POSTGRES_PASSWORD | str  | Пароль к базе данных                                                                       | postgres                   |
| POSTGRES_DB       | str  | Название базы данных                                                                       | app_example                |
| POSTGRES_HOST     | str  | host/название контейнера                                                                   | app_postgis                |
| POSTGRES_PORT     | int  | port, по умолчанию 5432                                                                    | 5432                       |
| POSTGRES_ECHO   | bool | Флаг для логирования всех запросов, ```true``` используется только на локальных машиных при разработке | ```True``` или ```False``` |
| POSTGRES_MAX_OVERFLOW   | int  | Максимальный размер переполнения пула                                                      | 20                         |
| POSTGRES_POOL_SIZE   | int  | Размер поддерживаемого пула                                                                | 10                         |


#### CORS
| Переменная | Тип  | Описание                                                                                                                                                                                                     | Пример                                  |
|--|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------|
| CORS_ORIGINS | list | Список источников(адреса клиентов), для предоставлении доступа к ресурсам. Если не указать данную переменную, или если в списке будет присутствовать символ "*" - то доступ к ресурсам будет предоставлен всем | ["127.0.0.1", "testdomen.ru"] или ["*"] |


#### Мониторинг ошибок SENTRY
| Переменная | Тип | Описание                                                                                                          | Пример                                                                                             |
|--|-----|-------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------|
| SENTRY_DSN | str | DSN полученный в настройках проекта sentry. Чтобы не отслеживать ошибки, можно не передавать переменную в проект. | ```https://099711de3c48ebe26c7f1bde234ca1f7@o4506138282491904.ingest.sentry.io/4412138283737088``` |
| SENTRY_ENVIRONMENT | str | Окружение проекта                                                                                                 | dev, test, prod и т.д    


#### Redis
| Переменная | Тип | Описание                      | Пример                                 |
|------------|-----|-------------------------------|----------------------------------------|
| REDIS_DSN  | str | Адрес для подключения к redis | redis://app_redis or redis://localhost |

</details>